#DNS Enumeration Cheat Sheet
# MrR3b00t (Daniel Card)
# Xservus Limited
# 20-01-2019
# Version 0.1

#Domain Name System Enumeration

#Discover DNS Servers (TCP Scan) nmap -p 53 10.50.xx.x/24


#Tools = nslookup, dig, dnsrecon, sublist3r

#########
#nslookup routine for quick reverse lookup
# you can one liner this but its useful to have a tool shell as you don't know what you will find
#########
nslookup
server 192.168.2.29
#forward lookup
xlab.local
#mx lookup
set type=mx
xlab.local
#reverse lookup
192.168.2.29

########
##DIG##
######

# DIG = Domain Internet Groper
# Useful tool, sometimes will return more than simply doing an NS lookup on a domain

#get IP
dig www.xservus.com

#get IP using another DNS Server (useful if UPD 53 is open on the target server)
dig -server 8.8.8.8 www.xservus.com

#Do a reverse lookup
dig @8.8.8.8 -x 8.8.8.8

#show only ip
dig www.xservus.com +short

#check MX records
dig xservus.com MX

#check name server records
dig xservus.com NS

#get only TXT records
dig xservus.com TXT

#dig all the things
dig xservus.com ANY

#zone transfer using dig
dig @10.50.96.x foocampus.xxx -t AXFR +nocookie

#zone transfer using host
host -t axfr foocampus.xxx 10.50.96.x

#dig and trace the name resolution requests -thanks to @an0key
dig +trace foocampus.com 10.50.96.15


#######################
#SUBDOMAIN ENUMERATION#
#######################
sublist3r -d xservus.com -t 3 -e bing

##########
#DNS ENUM#
##########
dnsenum --dnsserver 10.50.96.xx -enum intranet.foocampus.xx
dnsenum --dnsserver 10.50.96.xx -enum management.foocampus.xx
dnsenum --dnsserver 10.50.96.xx -enum www.foocampus.xx
###########
#DNS RECON#
###########

dnsrecon -d xservus.com -D /usr/share/wordlists/dnsmap.txt -t std --xml dnsrecon.xml
#lookup xservus.com using a wordlit using standard type of enum, output to xml filed dnsrecon.xml
dnsrecon -d xservus.com -D /usr/share/wordlists/dnsmap.txt -t std --xml dnsrecon.xml --name_server 8.8.8.8

#zone transfer
dnsrecon.py -d xservus.com -t axfr
